<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>404: Coffee Break Gone Wrong | {{ .Site.Title }}</title>
    <meta name="description" content="Page not found - Lost in the code matrix">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    {{ with resources.Get "scss/refactored/404/main.scss" }}
    {{ $opts := dict
        "enableSourceMap" hugo.IsDevelopment
        "outputStyle" (cond hugo.IsDevelopment "expanded" "compressed")
        "targetPath" "refactored/css/404/main.css"
        "transpiler" "libsass"
        "vars" site.Params.styles
        "includePaths" (slice "scss/refactored/")
    }}
    {{ with . | toCSS $opts }}
    {{ if hugo.IsDevelopment }}
    <link rel="stylesheet" href="{{ .RelPermalink }}">
    {{ else }}
    {{ with . | fingerprint }}
    <link rel="stylesheet" href="{{ .RelPermalink }}" integrity="{{ .Data.Integrity }}" crossorigin="anonymous">
    {{ end }}
    {{ end }}
    {{ end }}
    {{ end }}
    <style>
        .result-title {
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .result-excerpt {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .no-results {
            padding: 2rem;
            text-align: center;
            color: var(--text-muted);
            font-style: italic;
        }
    </style>
</head>
<body>
    <!-- Theme Toggle -->
    <button 
        class="theme-toggle" 
        id="themeToggle" 
        title="Toggle theme"
        role="button"
        aria-label="Toggle between light and dark theme"
        tabindex="-1"
    >
      üåô
    </button>

    <!-- Matrix Rain Background -->
    <div class="matrix-rain" id="matrixRain"></div>

    <!-- CRT Container -->
    <div class="crt-container">
        <div class="error-container">
            <!-- Glitchy Coffee Cup -->
            <div class="coffee-glitch">‚òïüí•</div>

            <!-- Error Code -->
            <div class="error-code">404</div>

            <!-- Error Title -->
            <h1 class="error-title" lang="en">Coffee Break Gone Wrong</h1>

            <!-- Rotating Error Messages -->
            <div class="error-message" aria-live="polite">
                <div class="rotating-message" lang="en">This page is debugging itself in another dimension...</div>
                <div class="rotating-message" lang="en">404: Page went for coffee and never came back ‚òï</div>
                <div class="rotating-message" lang="en">Error: Page.exe has stopped working (probably needs more caffeine)</div>
                <div class="rotating-message" lang="en">Lost in the code matrix... Send help (and coffee)!</div>
            </div>
            <!-- Search Container -->
            <div class="search-container">
                <div class="search-wrapper">
                    <input 
                        type="text" 
                        class="search-input" 
                        id="searchInput" 
                        placeholder="$ search the codebase..."
                        aria-label="Search the site for posts and content"
                        tabindex="0"
                    >
                    <button 
                        class="search-btn" 
                        id="searchBtn"
                        title="Search"
                        aria-label="perform search"
                        tabindex="0"
                        interestFor="searchInput"
                        >
                        <i class="fas fa-search"></i>
                    </button>
                </div>
                <div 
                    class="search-results" 
                    id="searchResults"
                    aria-live="polite"
                    aria-atomic="true"
                ></div>
            </div>

            <!-- Action Buttons -->
            <div 
                class="action-buttons" 
                role="navigation" 
                aria-label="error page actions"
                >
                <a 
                    href="/" 
                    role="link"
                    class="btn btn-primary"
                    aria-label="return to home page"
                    tabindex="0"
                    autofocus
                    command="home"
                    type="button"
                    >
                    <i class="fas fa-home"></i>
                    {{ T "returnToBase"}}
                    <span aria-atomic="true" aria-label="this item has autofocus">‚èé</span>
                </a>
                <button 
                    class="btn btn-secondary" 
                    id="randomPostBtn"
                    role="link"
                    aria-label="go to a random post"
                    tabindex="0"
                    lang="en"
                    type="button"
                    >
                    <i class="fas fa-random"></i>
                    Random Post
                </button>
            </div>

            <!-- Git Log Section -->
            <div class="git-log-section" role="main" aria-label="recent posts log">
                <div class="git-log-header">
                    <i class="fab fa-git-alt"></i>
                    git log --oneline --recent
                </div>
                <div class="git-log-content" id="gitLogContent">
                    <div class="git-commit">
                        <span 
                            class="commit-hash"
                            aria-hidden="true"
                            >
                            a1b2c3d
                        </span>
                        <div class="commit-message">Loading recent commits...</div>
                        <span 
                            class="commit-date"
                            aria-hidden="true"
                            >
                            just now
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Theme toggle functionality
        const themeToggle = document.getElementById('themeToggle');
        const htmlElement = document.documentElement;

        function getInitialTheme() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) return savedTheme;
            return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        }

        function updateThemeIcon() {
            const isDark = htmlElement.getAttribute('data-theme') === 'dark';
            themeToggle.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
        }

        const currentTheme = getInitialTheme();
        htmlElement.setAttribute('data-theme', currentTheme);
        updateThemeIcon();

        themeToggle.addEventListener('click', () => {
            const currentTheme = htmlElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            htmlElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon();
        });

        // Matrix rain effect
        function createMatrixRain() {
            const matrixRain = document.getElementById('matrixRain');
            const chars = '01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ„Çø„ÉÅ„ÉÑ„ÉÜ„Éà„Éä„Éã„Éå„Éç„Éé„Éè„Éí„Éï„Éò„Éõ„Éû„Éü„É†„É°„É¢„É§„É¶„É®„É©„É™„É´„É¨„É≠„ÉØ„É≤„É≥';

            for (let i = 0; i < 50; i++) {
                const column = document.createElement('div');
                column.className = 'matrix-column';
                column.style.left = Math.random() * 100 + '%';
                column.style.animationDuration = (Math.random() * 3 + 2) + 's';
                column.style.animationDelay = Math.random() * 2 + 's';

                let text = '';
                for (let j = 0; j < 20; j++) {
                    text += chars[Math.floor(Math.random() * chars.length)] + '<br>';
                }
                column.innerHTML = text;

                matrixRain.appendChild(column);
            }
        }

        // Floating particles
        function createParticle() {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.fontSize = (Math.random() * 20 + 10) + 'px';
            particle.style.color = Math.random() > 0.5 ? 'var(--accent-primary)' : 'var(--accent-secondary)';
            particle.style.animationDuration = (Math.random() * 10 + 5) + 's';

            const symbols = ['{}', '[]', '()', '<>', '/>', '&&', '||', '==', '!=', '++', '--', '=>'];
            particle.textContent = symbols[Math.floor(Math.random() * symbols.length)];

            document.body.appendChild(particle);

            setTimeout(() => {
                particle.remove();
            }, 15000);
        }

        // Search functionality
        let searchData = [];

        async function loadSearchData() {
            try {
                // Try multiple possible endpoints
                const endpoints = ['/index.json', '/'];

                for (const endpoint of endpoints) {
                    try {
                        const response = await fetch(endpoint);
                        if (response.ok) {
                            if (endpoint === '/') {
                                // If we're fetching the home page, we need to extract JSON from it
                                const text = await response.text();
                                // This is a fallback - in a real scenario, we'd have proper JSON endpoint
                                searchData = [
                                    {
                                        title: "Welcome to LofiCode Theme",
                                        url: "/posts/welcome-to-loficode/",
                                        excerpt: "Welcome to the LofiCode Hugo theme! This theme is designed for developers and creatives who want to create a warm, inviting blog with a retro lo-fi aesthetic."
                                    },
                                    {
                                        title: "Git Workflow Zen: Finding Peace in Version Control",
                                        url: "/posts/git-workflow-zen/",
                                        excerpt: "Version control doesn't have to be stressful. Like a well-organized workspace or a perfectly brewed cup of coffee, a good Git workflow can bring zen to your development process."
                                    },
                                    {
                                        title: "Building Cozy Digital Workspaces",
                                        url: "/posts/building-cozy-workspaces/",
                                        excerpt: "Creating a workspace that sparks joy and productivity is an art form. Whether you're working from home, a coffee shop, or a traditional office, the right environment can make all the difference."
                                    },
                                    {
                                        title: "JavaScript Debugging Like a Pro",
                                        url: "/posts/javascript-debugging-tips/",
                                        excerpt: "Debugging JavaScript can feel like solving a mystery novel. You have clues scattered throughout your code, and you need to piece them together to find the culprit."
                                    },
                                    {
                                        title: "Coffee and Code: The Perfect Pairing",
                                        url: "/posts/coffee-and-code/",
                                        excerpt: "There's something magical about the combination of freshly brewed coffee and clean code. Both require patience, attention to detail, and a deep appreciation for the craft."
                                    }
                                ];
                                return;
                            } else {
                                searchData = await response.json();
                                return;
                            }
                        }
                    } catch (e) {
                        continue;
                    }
                }

                // Fallback data if all endpoints fail
                searchData = [
                    {
                        title: "Welcome to LofiCode Theme",
                        url: "/posts/welcome-to-loficode/",
                        excerpt: "Welcome to the LofiCode Hugo theme! This theme is designed for developers and creatives who want to create a warm, inviting blog with a retro lo-fi aesthetic."
                    },
                    {
                        title: "Git Workflow Zen: Finding Peace in Version Control",
                        url: "/posts/git-workflow-zen/",
                        excerpt: "Version control doesn't have to be stressful. Like a well-organized workspace or a perfectly brewed cup of coffee, a good Git workflow can bring zen to your development process."
                    },
                    {
                        title: "Building Cozy Digital Workspaces",
                        url: "/posts/building-cozy-workspaces/",
                        excerpt: "Creating a workspace that sparks joy and productivity is an art form. Whether you're working from home, a coffee shop, or a traditional office, the right environment can make all the difference."
                    },
                    {
                        title: "JavaScript Debugging Like a Pro",
                        url: "/posts/javascript-debugging-tips/",
                        excerpt: "Debugging JavaScript can feel like solving a mystery novel. You have clues scattered throughout your code, and you need to piece them together to find the culprit."
                    },
                    {
                        title: "Coffee and Code: The Perfect Pairing",
                        url: "/posts/coffee-and-code/",
                        excerpt: "There's something magical about the combination of freshly brewed coffee and clean code. Both require patience, attention to detail, and a deep appreciation for the craft."
                    }
                ];
            } catch (error) {
                console.log('Could not load search data, using fallback');
                // Fallback search data
                searchData = [
                    {
                        title: "Welcome to LofiCode Theme",
                        url: "/posts/welcome-to-loficode/",
                        excerpt: "Welcome to the LofiCode Hugo theme! This theme is designed for developers and creatives who want to create a warm, inviting blog with a retro lo-fi aesthetic."
                    },
                    {
                        title: "Git Workflow Zen: Finding Peace in Version Control",
                        url: "/posts/git-workflow-zen/",
                        excerpt: "Version control doesn't have to be stressful. Like a well-organized workspace or a perfectly brewed cup of coffee, a good Git workflow can bring zen to your development process."
                    },
                    {
                        title: "Building Cozy Digital Workspaces",
                        url: "/posts/building-cozy-workspaces/",
                        excerpt: "Creating a workspace that sparks joy and productivity is an art form. Whether you're working from home, a coffee shop, or a traditional office, the right environment can make all the difference."
                    },
                    {
                        title: "JavaScript Debugging Like a Pro",
                        url: "/posts/javascript-debugging-tips/",
                        excerpt: "Debugging JavaScript can feel like solving a mystery novel. You have clues scattered throughout your code, and you need to piece them together to find the culprit."
                    },
                    {
                        title: "Coffee and Code: The Perfect Pairing",
                        url: "/posts/coffee-and-code/",
                        excerpt: "There's something magical about the combination of freshly brewed coffee and clean code. Both require patience, attention to detail, and a deep appreciation for the craft."
                    }
                ];
            }
        }

        function performSearch(query) {
            const results = document.getElementById('searchResults');

            if (!query.trim()) {
                results.classList.remove('show');
                return;
            }

            const searchLower = query.toLowerCase();
            const matches = searchData.filter(post =>
                post.title.toLowerCase().includes(searchLower) ||
                post.excerpt.toLowerCase().includes(searchLower) ||
                (post.tags && post.tags.some(tag => tag.toLowerCase().includes(searchLower)))
            ).slice(0, 5);

            if (matches.length === 0) {
                results.innerHTML = '<div class="no-results">No posts found. Try different keywords!</div>';
            } else {
                results.innerHTML = matches.map(post => `
                    <div class="search-result" onclick="window.location.href='${post.url}'">
                        <div class="result-title">${post.title}</div>
                        <div class="result-excerpt">${post.excerpt.substring(0, 100)}...</div>
                    </div>
                `).join('');
            }

            results.classList.add('show');
        }

        // Random post functionality
        function getRandomPost() {
            if (searchData.length > 0) {
                const randomPost = searchData[Math.floor(Math.random() * searchData.length)];
                window.location.href = randomPost.url;
            } else {
                window.location.href = '/';
            }
        }

        // Load recent posts for git log
        function loadRecentPosts() {
            const gitLogContent = document.getElementById('gitLogContent');

            if (searchData.length > 0) {
                const recentPosts = searchData.slice(0, 5);
                gitLogContent.innerHTML = recentPosts.map((post, index) => {
                    const hash = Math.random().toString(36).substring(2, 9);
                    const timeAgo = ['2 hours ago', '1 day ago', '3 days ago', '1 week ago', '2 weeks ago'][index] || '1 month ago';

                    return `
                        <div class="git-commit">
                            <span class="commit-hash">${hash}</span>
                            <div class="commit-message">
                                <a href="${post.url}">feat: ${post.title}</a>
                            </div>
                            <span class="commit-date">${timeAgo}</span>
                        </div>
                    `;
                }).join('');
            }
        }

        // Event listeners
        document.getElementById('searchInput').addEventListener('input', (e) => {
            performSearch(e.target.value);
        });

        document.getElementById('searchBtn').addEventListener('click', () => {
            const query = document.getElementById('searchInput').value;
            if (query.trim()) {
                performSearch(query);
            }
        });

        document.getElementById('randomPostBtn').addEventListener('click', getRandomPost);

        // Close search results when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.search-wrapper')) {
                document.getElementById('searchResults').classList.remove('show');
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.getElementById('searchResults').classList.remove('show');
            }
            if (e.key === '/' && !e.target.matches('input')) {
                e.preventDefault();
                document.getElementById('searchInput').focus();
            }
        });

        // Initialize everything
        createMatrixRain();
        loadSearchData().then(() => {
            loadRecentPosts();
        });

        // Create particles periodically
        setInterval(createParticle, 2000);

        // Console easter egg
        console.log(`
        ‚òï 404: Coffee Break Gone Wrong ‚òï

        Well, well, well... looks like you found the console!

        Here are some secret shortcuts:
        - Press '/' to focus the search box
        - Press 'Escape' to close search results
        - The matrix rain is made of real code characters!

        Built with love, coffee, and way too many glitch effects.
        Now get back to coding! ‚ú®
        `);
    </script>
</body>
</html>
